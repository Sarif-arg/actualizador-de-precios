<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Precios Portofino</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/alpinejs/3.13.2/cdn.min.js" defer></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-6">
    <style>
    @media only screen and (max-width: 570px), (min-device-width: 568px) and (max-device-width: 981px) {

      /* Hacer que todo se comporte como bloques */
      table, thead, tbody, th, td, tr { 
        display: block; 
      }

      /* Escondemos headers visualmente */
      thead tr { 
        position: absolute;
        top: -9999px;
        left: -9999px;
      }

      tr { 
        border: 1px solid #ddd; 
        margin-bottom: 1rem;
        border-radius: 8px;
        background: #fff;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      }

      td { 
        border: none;
        border-bottom: 1px solid #eee; 
        position: relative;
        padding-left: 50%;  
        text-align: left;
      }

      td:before { 
        position: absolute;
        top: 6px;
        left: 6px;
        width: 45%; 
        padding-right: 10px; 
        white-space: nowrap;
        font-weight: 600;
        color: #555;
      }
    
    /* Etiquetas para cada celda */
      td::before {
        content: attr(data-label);
      }
    }
  </style>
  <div class="w-full max-w-6xl mx-auto space-y-4" x-data="{ open: null }" id="acordeones">
    <!-- Aquí se generarán los acordeones dinámicamente -->
  </div>

  <script>

    async function cargarDatos() {
      try {
        const response = await fetch("datos.json");
        const data = await response.json();

        const acordeonesContainer = document.getElementById("acordeones");
        let index = 0;

        for (const [sector, lotes] of Object.entries(data)) {
          index++;
          const acordeon = document.createElement("div");
          acordeon.className = "border border-gray-300 rounded-2xl shadow bg-white overflow-hidden";

          acordeon.innerHTML = `
            <button 
              @click="open === ${index} ? open = null : open = ${index}"
              class="w-full flex justify-between items-center px-6 py-4 text-lg font-semibold bg-gray-200 hover:bg-gray-300 transition"
            >
              <span>Sector ${sector}</span>
              <svg :class="open === ${index} ? 'rotate-180' : ''" class="w-6 h-6 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <div x-show="open === ${index}" x-transition class="p-4 overflow-x-auto">
              <table class="min-w-full border-collapse border border-gray-300 text-sm">
                <thead class="bg-gray-200">
                  <tr>
                    <th rowspan="2" class="border border-gray-300 px-3 py-2 w-[40px]">N°</th>
                    <th rowspan="2" class="border border-gray-300 px-3 py-2 w-[90px]">SUP. m²</th>
                    <th rowspan="2" class="border border-gray-300 px-3 py-2 w-[120px]">PRECIO DE CONTADO</th>
                    <th colspan="3" class="border border-gray-300 px-3 py-2 w-[120px]">PLAN 36</th>
                    <th colspan="3" class="border border-gray-300 px-3 py-2 w-[120px]">PLAN 60</th>
                    <th rowspan="2" class="border border-gray-300 px-3 py-2 w-[110px]">ENTREGA</th>
                    <th rowspan="2" class="border border-gray-300 px-3 py-2 w-[110px]">ESTADO</th>
                  </tr>
                  <tr>
                    <th class="border border-gray-300 px-3 py-2 w-[110px]">ENTREGA</th>
                    <th class="border border-gray-300 px-3 py-2 w-[120px]">36 CUOTAS DE</th>
                    <th class="border border-gray-300 px-3 py-2 w-[120px]">PRECIO FINAL</th>
                    <th class="border border-gray-300 px-3 py-2 w-[110px]">ENTREGA</th>
                    <th class="border border-gray-300 px-3 py-2 w-[120px]">60 CUOTAS DE</th>
                    <th class="border border-gray-300 px-3 py-2 w-[120px]">PRECIO FINAL</th>
                  </tr>
                </thead>
                <tbody>
                  ${lotes.map(lote => `
                    <tr class="hover:bg-gray-50 ${getEstadoClass(lote.estado)}">
                      <td data-label="N°">${lote.numero || ""}</td>
                      <td data-label="SUP. m²">${lote.superficie || ""}</td>
                      <td data-label="PRECIO DE CONTADO">${lote.precio_contado || ""}</td>
                      <td data-label="ENTREGA (Plan 36)">${lote.plan36_entrega_inicial || ""}</td>
                      <td data-label="36 CUOTAS DE">${lote.plan36_cuotas || ""}</td>
                      <td data-label="PRECIO FINAL (Plan 36)">${lote.plan36_precio_final || ""}</td>
                      <td data-label="ENTREGA (Plan 60)">${lote.plan60_entrega_inicial || ""}</td>
                      <td data-label="60 CUOTAS DE">${lote.plan60_cuotas || ""}</td>
                      <td data-label="PRECIO FINAL (Plan 60)">${lote.plan60_precio_final || ""}</td>
                      <td data-label="FECHA ENTREGA">${lote.fecha_entrega || ""}</td>
                      <td data-label="ESTADO">${lote.estado || ""}</td>
                    </tr>
                  `).join("")}
                </tbody>
              </table>
            </div>
          `;

          acordeonesContainer.appendChild(acordeon);
        }
      } catch (error) {
        console.error("Error cargando datos:", error);
      }
    }

    // Colores pastel según estado
    function getEstadoClass(estado) {
      switch ((estado || "").toLowerCase()) {
        case "disponible":
          return "bg-green-100 text-green-800 font-semibold"; // verde pastel
        case "reservado":
          return "bg-yellow-100 text-yellow-800 font-semibold"; // amarillo pastel
        case "vendido":
          return "bg-red-100 text-red-800 font-semibold"; // rojo pastel
        default:
          return "";
      }
    }

    cargarDatos();
  </script>
</body>
</html>
